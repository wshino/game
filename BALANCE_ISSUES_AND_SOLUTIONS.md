# ゲームバランス問題と改善案

## 🚨 発見された致命的な問題

### 1. ゲームが詰んでいる状態

**現状:**
- 初期資金: 1,000G
- 初期地点: リスボン
- 初期船: カラベル船（積載量100）

**問題点:**
1. リスボンから物理的に実行可能なルートは**セビリアのみ**
   - 他の港は物資だけで積載量オーバー
   - 例: 長崎は物資1,200個必要だが、船は100個しか積めない

2. セビリアへのすべての貿易ルートで**損失が発生**
   - 最善でもワインで-188Gの損失

3. 利益の出る貿易ルート（セビリア→リスボンの金鉱石）は**スタート地点から実行不可能**

### 2. 根本的な原因

#### 原因1: 売買差額が大きすぎる（20%）
- 購入価格の80%でしか売却できない
- これにより、価格差があっても利益が出ない

**影響:**
- 手数料なしの場合: 166の利益ルート
- 現在（20%手数料）: 102の利益ルート
- **39%のルートが消失**

#### 原因2: 物資消費システムが厳しすぎる
- 乗員1人あたり1日に食糧1個、水1個が必要
- カラベル船: 20人 × 30日（長崎） = 1,200個
- これは船の積載量の**12倍**

#### 原因3: 船の積載量が小さすぎる
- カラベル船: 100個
- 短距離（セビリア2日）でも物資80個で残り20個しかない
- 商品を大量に運べない → 利益が出ない

## 💡 改善案

### 【案1】売買差額を縮小（推奨）

**現在:** 売却価格 = 購入価格 × 0.8（20%マージン）
**提案:** 売却価格 = 購入価格 × 0.95（5%マージン）

**効果:**
- 多くのルートで利益が出るようになる
- リスボン→セビリアでも利益が出る可能性

**実装:**
```javascript
// game.js の getPrice 関数
function getPrice(goodId, isBuying = true) {
    const good = goods[goodId];
    const multiplier = portPrices[gameState.currentPort][goodId];
    const basePrice = good.basePrice * multiplier;
    const randomFactor = 0.9 + Math.random() * 0.2;
    const price = Math.round(basePrice * randomFactor);
    // 売却時のマージンを5%に変更
    return isBuying ? price : Math.round(price * 0.95);  // 0.8 → 0.95
}
```

### 【案2】初期資金を増額

**現在:** 1,000G
**提案:** 3,000G または 5,000G

**効果:**
- 損失を出しても数回は貿易できる
- セビリアで金鉱石を買ってリスボンに戻る戦略が可能に

**実装:**
```javascript
// game.js
const gameState = {
    gold: 5000,  // 1000 → 5000
    // ...
};
```

### 【案3】カラベル船の積載量を増加

**現在:** 100個
**提案:** 200個

**効果:**
- 中距離の港にも行けるようになる
- 商品を多く積めるため、利益が増える

**実装:**
```javascript
// game.js
const shipUpgrades = [
    {
        name: 'カラベル船',
        capacity: 200,  // 100 → 200
        speed: 1,
        cost: 0,
        crew: 20,
        description: '小型で機動性の高い船'
    },
    // ...
];
```

### 【案4】物資消費量を削減

**現在:** 乗員1人あたり1日に食糧1個、水1個
**提案:** 乗員1人あたり1日に食糧0.5個、水0.5個

**効果:**
- 長距離航海が可能になる
- 商品を積むスペースが増える

**実装:**
```javascript
// game.js の calculateRequiredSupplies 関数
function calculateRequiredSupplies(days) {
    const crew = gameState.ship.crew;
    return {
        food: Math.ceil(crew * days * 0.5),  // 1.0 → 0.5
        water: Math.ceil(crew * days * 0.5)  // 1.0 → 0.5
    };
}
```

### 【案5】スタート地点をセビリアに変更（簡易版）

**現在:** リスボン
**提案:** セビリア

**効果:**
- 初手から金鉱石→リスボンの高利益ルートが使える
- すぐにキャラック船を買える

**実装:**
```javascript
// game.js
const gameState = {
    gold: 1000,
    currentPort: 'seville',  // 'lisbon' → 'seville'
    // ...
};
```

## 📊 推奨する改善の組み合わせ

### パターンA: 最小限の変更
1. **売買差額を5%に縮小**（案1）
2. **初期資金を3,000Gに増額**（案2）

### パターンB: バランスを取った変更
1. **売買差額を5%に縮小**（案1）
2. **カラベル船の積載量を200に増加**（案3）
3. **物資消費量を半分に削減**（案4）

### パターンC: 根本的な再設計
1. **売買差額を5%に縮小**（案1）
2. **初期資金を5,000Gに増額**（案2）
3. **カラベル船の積載量を200に増加**（案3）
4. **物資消費量を半分に削減**（案4）
5. **スタート地点をセビリアに変更**（案5）

## 🎯 即座に実装すべき最優先事項

**最優先:** 売買差額を5%に縮小（案1）

理由:
- 最も簡単に実装できる（1行の変更）
- 最も大きな効果が期待できる
- ゲームバランスを根本から改善

## 📈 改善後の期待される効果

### 売買差額を5%に変更した場合のシミュレーション

リスボン → セビリア → リスボン（金鉱石、逆ルート）:
- 現在: -390G の損失
- 改善後: +XXG の利益（要計算）

セビリア → リスボン → セビリア（金鉱石）:
- 現在: +2,772G（カラベル船）
- 改善後: さらに増加

## 📝 まとめ

現在のゲームは**完全に詰んだ状態**です。プレイヤーは初手でどの選択をしても損失を出し、資金が減り続けます。

**最低限必要な変更:**
- 売買差額を5%に縮小

**推奨する変更:**
- 売買差額5% + カラベル船積載量200 + 物資消費量半減

これにより、プレイヤーは初期状態から利益を出せるようになり、ゲームとして成立します。
