# 大航海時代ゲーム - 完全仕様書

## 目次
1. [ゲーム概要](#ゲーム概要)
2. [ゲームの目的](#ゲームの目的)
3. [港システム](#港システム)
4. [商品システム](#商品システム)
5. [船システム](#船システム)
6. [貿易システム](#貿易システム)
7. [航海システム](#航海システム)
8. [補給システム](#補給システム)
9. [オートパイロットシステム](#オートパイロットシステム)
10. [セーブ/ロードシステム](#セーブロードシステム)
11. [UI仕様](#ui仕様)
12. [計算式](#計算式)
13. [天候システム](#天候システム)
14. [在庫管理システム](#在庫管理システム)
15. [ゲーム進行フロー](#ゲーム進行フロー)

---

## ゲーム概要

### 基本情報
- **ゲーム名**: 大航海時代
- **ジャンル**: 貿易シミュレーション
- **プラットフォーム**: Webブラウザ（HTML5/JavaScript）
- **技術スタック**: ES6モジュール、CommonJS対応
- **言語**: 日本語

### コンセプト
15-16世紀の大航海時代を舞台に、プレイヤーは船長となり、7つの歴史的な港を巡りながら貿易を行い、富を築くゲーム。

---

## ゲームの目的

### 主目的
- 貿易で富を蓄積する
- 船をアップグレードして積載量と速度を向上させる
- 世界中の港を巡り、最も効率的な貿易ルートを見つける

### 副目的
- 各港の特性を理解する
- 天候変動に対応する
- オートパイロットで自動化する

---

## 港システム

### 実装港（7港）

#### 1. リスボン（Lisbon）🇵🇹
- **説明**: ポルトガルの首都。冒険の始まりの地。
- **港サイズ**: large（大規模港）
- **歴史的背景**: 15世紀末から16世紀にかけて、大航海時代の中心として急成長。人口10万人超。
- **座標**: (39, 135)
- **在庫設定**:
  - 最大在庫: 100個
  - 在庫回復率: 8個/日

#### 2. セビリア（Seville）🇪🇸
- **説明**: スペインの港町。新大陸への玄関口。
- **港サイズ**: large（大規模港）
- **歴史的背景**: 16世紀、新大陸との貿易を独占し、スペイン随一の商業都市に成長。
- **座標**: (60, 151)
- **在庫設定**:
  - 最大在庫: 100個
  - 在庫回復率: 8個/日

#### 3. ヴェネツィア（Venice）🇮🇹
- **説明**: 水の都。東方貿易の中心地。
- **港サイズ**: very_large（最大規模港）
- **歴史的背景**: 15世紀、人口15-18万人を擁し、地中海貿易を支配する最大級の商業共和国。
- **座標**: (182, 55)
- **在庫設定**:
  - 最大在庫: 150個
  - 在庫回復率: 12個/日

#### 4. アレクサンドリア（Alexandria）🇪🇬
- **説明**: エジプトの古都。香辛料の集積地。
- **港サイズ**: medium（中規模港）
- **歴史的背景**: 15世紀マムルーク朝下で往時の栄華からは衰退も、依然として香辛料貿易の要衝。
- **座標**: (300, 226)
- **在庫設定**:
  - 最大在庫: 60個
  - 在庫回復率: 5個/日

#### 5. カリカット（Calicut）🇮🇳
- **説明**: インドの港町。胡椒の産地。
- **港サイズ**: medium（中規模港）
- **歴史的背景**: 15-16世紀、インド西海岸最大の香辛料貿易港。ヴァスコ・ダ・ガマが到達。
- **座標**: (605, 465)
- **在庫設定**:
  - 最大在庫: 60個
  - 在庫回復率: 5個/日

#### 6. マラッカ（Malacca）🇲🇾
- **説明**: 東南アジアの交易拠点。
- **港サイズ**: medium（中規模港）
- **歴史的背景**: 15世紀、マラッカ王国の首都として東西貿易の要衝。1511年ポルトガルに征服。
- **座標**: (782, 574)
- **在庫設定**:
  - 最大在庫: 60個
  - 在庫回復率: 5個/日

#### 7. 長崎（Nagasaki）🇯🇵
- **説明**: 日本の港町。銀と絹の取引が盛ん。
- **港サイズ**: small（小規模港）
- **歴史的背景**: 1570年代、ポルトガル貿易の拠点として開港。それまでは小さな漁村。
- **座標**: (966, 207)
- **在庫設定**:
  - 最大在庫: 30個
  - 在庫回復率: 3個/日

### 港間距離（基準速度1.0での日数）

|           | リスボン | セビリア | ヴェネツィア | アレクサンドリア | カリカット | マラッカ | 長崎 |
|-----------|---------|---------|------------|----------------|-----------|---------|------|
| リスボン    | 0       | 2       | 5          | 7              | 15        | 20      | 30   |
| セビリア    | 2       | 0       | 5          | 6              | 14        | 19      | 29   |
| ヴェネツィア | 5       | 5       | 0          | 3              | 12        | 17      | 27   |
| アレクサンドリア | 7   | 6       | 3          | 0              | 10        | 15      | 25   |
| カリカット  | 15      | 14      | 12         | 10             | 0         | 5       | 15   |
| マラッカ    | 20      | 19      | 17         | 15             | 5         | 0       | 10   |
| 長崎       | 30      | 29      | 27         | 25             | 15        | 10      | 0    |

### 航路システム
- 各港間には陸地を避けたウェイポイント付き航路が定義されている
- 航路に沿って船が移動する視覚的表現がある
- 航路がない場合は直線航路が使用される

---

## 商品システム

### 取引可能商品（8種類）

#### 1. ワイン 🍷
- **基準価格**: 50G
- **説明**: ヨーロッパで生産される高級飲料

#### 2. 織物 🧵
- **基準価格**: 80G
- **説明**: 高品質な布地

#### 3. 香辛料 🌶️
- **基準価格**: 150G
- **説明**: 東洋からの貴重品

#### 4. 絹 🎀
- **基準価格**: 200G
- **説明**: 東洋の高級繊維

#### 5. 金鉱石 🏆
- **基準価格**: 300G
- **説明**: 貴重な金属

#### 6. 陶器 🏺
- **基準価格**: 120G
- **説明**: 芸術品としての価値

#### 7. 茶 🍵
- **基準価格**: 100G
- **説明**: 東洋の嗜好品

#### 8. 銀 💍
- **基準価格**: 250G
- **説明**: 貴金属

### 補給品（2種類）

#### 食糧 🍖
- **基準価格**: 2G
- **用途**: 航海中の乗組員の食料

#### 水 💧
- **基準価格**: 1G
- **用途**: 航海中の飲料水

### 港別価格係数

各港で商品の価格が異なる（基準価格 × 港別係数）

| 商品 | リスボン | セビリア | ヴェネツィア | アレクサンドリア | カリカット | マラッカ | 長崎 |
|------|---------|---------|------------|----------------|-----------|---------|------|
| ワイン | 0.8 | 0.9 | 1.1 | 1.2 | 1.5 | 1.6 | 1.8 |
| 織物 | 1.0 | 0.9 | 0.7 | 1.1 | 1.3 | 1.4 | 1.5 |
| 香辛料 | 2.1 | 1.9 | 1.6 | 0.9 | 0.6 | 0.8 | 1.3 |
| 絹 | 1.9 | 1.8 | 1.4 | 1.2 | 1.0 | 0.9 | 0.7 |
| 金鉱石 | 1.5 | 0.7 | 1.6 | 1.4 | 1.3 | 1.2 | 1.5 |
| 陶器 | 1.5 | 1.6 | 1.4 | 1.3 | 1.2 | 1.0 | 0.8 |
| 茶 | 1.6 | 1.5 | 1.4 | 1.2 | 0.9 | 0.8 | 0.7 |
| 銀 | 1.4 | 1.3 | 1.5 | 1.4 | 1.2 | 1.1 | 0.6 |
| 食糧 | 1.0 | 0.9 | 1.1 | 1.2 | 1.0 | 1.1 | 1.3 |
| 水 | 1.0 | 0.9 | 1.0 | 1.3 | 1.1 | 1.2 | 1.2 |

### 価格変動
- 基準価格 × 港別係数 × ランダム係数（0.9～1.1）
- 買値と売値の関係: **売値 = 買値 × 0.8**

---

## 船システム

### 船の種類（4種類）

#### 1. カラベル船（初期船）
- **積載量**: 100
- **速度**: 1.0
- **乗員**: 20人
- **購入費**: 0G（初期装備）
- **説明**: 小型で機動性の高い船

#### 2. キャラック船
- **積載量**: 200
- **速度**: 1.2
- **乗員**: 40人
- **購入費**: 5,000G
- **説明**: 大型で積載量が多い船

#### 3. ガレオン船
- **積載量**: 300
- **速度**: 1.5
- **乗員**: 60人
- **購入費**: 15,000G
- **説明**: 最大級の貿易船

#### 4. 東インド会社船
- **積載量**: 500
- **速度**: 2.0
- **乗員**: 100人
- **購入費**: 50,000G
- **説明**: 伝説の大型貿易船

### アップグレード条件
- 十分な資金がある
- 現在の積荷が新しい船の積載量を超えない

---

## 貿易システム

### 購入（買う）
- **単品購入**: 1個ずつ購入
- **一括購入**: 以下の制約の中で最大数を購入
  - 所持金
  - 船の空き積載量
  - 港の在庫数

### 売却（売る）
- **単品売却**: 1個ずつ売却
- **一括売却**: 所持している商品を全て売却

### 制約
- 在庫が0の商品は購入不可
- 所持していない商品は売却不可
- 積載量が満タンの場合は購入不可
- 資金が不足している場合は購入不可

### 利益計算
```
利益/個 = 売却価格 - 購入価格
利益率(%) = (利益/個 ÷ 購入価格) × 100
総利益 = 利益/個 × 数量
```

---

## 航海システム

### 航海の流れ

#### 1. 目的地選択
- 現在港から他の港を選択
- 自動的に必要な補給品（食糧・水）を購入
- 選択状態になる（まだ出港しない）

#### 2. 積荷の準備
- 選択した港への推奨商品が表示される
- プレイヤーが商品を購入して積載する

#### 3. 航海開始
- 「航海を開始する」ボタンで出港
- 必要補給品が不足している場合は出港不可

#### 4. 航海中
- リアルタイムで航海が進行（15秒 = 1ゲーム日）
- 天候が変化し、速度に影響
- 航海モーダルで進行状況を表示
- 世界地図上で船の位置をアニメーション表示

#### 5. 到着
- 予定日数経過後に自動的に到着
- 補給品が消費される
- ゲーム時間が進む
- 港の在庫が回復する

### 航海時間計算
```
予定日数 = 基準日数 ÷ 船の速度
実際日数 = 予定日数 + 天候による遅延
```

### 航海中断
- ゲームを閉じても航海は継続
- 再開時に経過時間分の進行を計算
- 航海が完了していれば自動的に到着処理

---

## 補給システム

### 必要補給量計算
```
食糧必要量 = 乗員数 × 日数 × 0.07（切り上げ）
水必要量 = 乗員数 × 日数 × 0.07（切り上げ）
```

### 自動補給
- 目的地選択時に自動的に必要量を購入
- 既に十分な補給品がある場合は購入しない
- 資金や積載量が不足している場合は可能な範囲で購入

### 補給品消費
- 航海終了時に必要量を消費
- 不足している場合は航海開始不可

### 警告システム
- 補給品が積載量の75%以上を占める場合に警告
- より大きな船へのアップグレードを推奨

---

## オートパイロットシステム

### 概要
プレイヤーが離席中でも自動的に貿易を行う機能

### 設定
- **実行時間**: 1～24時間で設定可能
- **開始条件**: 航海中でないこと

### 動作フロー

#### 1. 初期化
- 開始時の資金を記録
- レポートを初期化

#### 2. サイクル実行（1秒ごと）
1. タイムアウトチェック
2. 航海中の場合は待機
3. 所持品がある場合は売却判断
4. 最適な貿易ルートを探索
5. 商品購入 → 航海 のサイクル実行

#### 3. 最適ルート探索アルゴリズム

**商品所持時:**
- 現在港での売却価値を計算
- 他の港での売却価値を計算
- 移動コスト（補給費用）を考慮
- 純利益が最大の港へ移動または現在港で売却

**商品非所持時:**
- 全港を評価対象として探索
- 各港への最適購入プランを計算:
  1. 移動に必要な補給費用を計算
  2. 補給用の積載スペースを確保
  3. 利益率の高い商品から優先的に選択（貪欲法）
  4. 資金と積載量の範囲内で購入プランを作成
- 総利益が最大のプランを実行

#### 4. 購入プラン実行
1. 水と食糧を購入
2. 計画した商品を順次購入
3. 在庫が不足している場合は待機（ただし港の最大在庫を超える量は待たない）
4. 購入完了後に出港

#### 5. 在庫待機ロジック
- 必要量の90%以上の在庫がある場合のみ購入
- 港の最大在庫で必要量を満たせない場合は待機せず現在の在庫で購入
- 待機中はゲーム時間を1日進めて在庫回復

#### 6. 終了処理
- 設定時間が経過したら自動停止
- 残っている商品を全て売却
- レポートを生成・表示

### オートパイロット設定値
```javascript
AUTOPILOT_CONFIG = {
    SAFETY_RESERVE: 50,                 // 緊急用予備金
    CARGO_UTILIZATION_RATIO: 0.98,      // 積載量使用率（98%）
    MINIMUM_PROFIT_THRESHOLD: 50,       // 最低利益閾値
    PROFIT_IMPROVEMENT_RATIO: 0.05,     // 利益改善率（5%）
    MINIMUM_PURCHASE_MULTIPLIER: 5,     // 最低購入量
    MINIMUM_CARGO_SPACE: 10,            // 最低空き積載量
    MAX_ESTIMATED_QUANTITY: 100,        // 最大見積り量
    STOCK_WAIT_THRESHOLD: 0.90          // 在庫待機閾値（90%）
}
```

### オフラインシミュレーション
- ゲームを閉じている間も進行を計算
- 最大10,000サイクルまで実行（安全装置）
- 航海は即座に完了として処理
- ログは無効化して高速実行

### レポート
- 開始資金 / 終了資金
- 総利益
- 経過ゲーム日数
- 実行した取引リスト
- 実行した航海リスト

---

## セーブ/ロードシステム

### 保存データ
LocalStorageに以下のデータを保存:

```javascript
{
    gold: Number,                    // 所持金
    currentPort: String,             // 現在の港ID
    inventory: Object,               // 所持品 {商品ID: 数量}
    ship: Object,                    // 船の情報
    logs: Array,                     // ログメッセージ
    gameTime: Number,                // 経過日数
    isVoyaging: Boolean,             // 航海中フラグ
    selectedDestination: String,     // 選択中の目的地
    // 航海中のデータ
    voyageStartTime: Number,         // 航海開始時刻（ミリ秒）
    voyageStartPort: String,         // 出発港
    voyageDestinationPort: String,   // 目的港
    voyageEstimatedDays: Number,     // 予定日数
    voyageActualDays: Number,        // 実際の日数
    voyageWeatherHistory: Array,     // 天候履歴
    // オートパイロットデータ
    autopilotActive: Boolean,
    autopilotStartTime: Number,
    autopilotDurationMinutes: Number,
    autopilotReport: Object,
    // 港在庫データ
    portInventory: Object            // {港ID: {商品ID: 数量}}
}
```

### 自動セーブ
- 全てのUI更新後に自動的にセーブ
- 航海開始時にセーブ
- オートパイロット開始/終了時にセーブ

### ロード時の処理
1. LocalStorageからデータ読み込み
2. ゲーム状態を復元
3. 船の定義を最新版に更新（後方互換性）
4. 航海中の場合は経過時間を計算
5. 完了している航海は自動的に到着処理
6. 進行中の航海はモーダル表示で再開

### データリセット
- 「データリセット」ボタンでセーブデータ削除
- 確認ダイアログ表示
- ページリロードで初期状態から再開

---

## UI仕様

### レイアウト構成

#### 1. ヘッダー
- タイトル: "🚢 大航海時代 🚢"
- サブタイトル: "未知なる海へ、富と栄光を求めて"

#### 2. ステータスバー（常時表示）
- 💰 資金: XXX ゴールド
- 🚢 船: 船名
- 👥 乗員: XX 人
- 📦 積載量: XX / XX
- 📅 経過日数: XX 日

#### 3. 船表示エリア
- 船のアイコン（🚢）
- 現在地表示

#### 4. アクションパネル（4つのパネル）

**a) 🏪 交易所パネル**
- 休息ボタン（1日経過、在庫回復）
- 商品リスト（8種類 + 2種類の補給品）
- 各商品ごとに:
  - 名前とアイコン
  - 買値 / 売値
  - 港の在庫数
  - 買う / 全部買う / 売る / 全部売る ボタン

**b) 🗺️ 航海先選択パネル**
- 選択中の目的地情報（選択時）:
  - 港名
  - 必要日数
  - 必要物資
  - 推奨商品（利益率順）
  - 航海開始ボタン
  - キャンセルボタン
- 他の航海先リスト:
  - 行ける＆儲かる港のみ表示
  - 利益率順にソート
  - 各港の情報:
    - 港名と説明
    - 必要物資
    - 最高利益商品
    - 選択ボタン

**c) ⚓ 船のアップグレードパネル**
- アップグレード可能な船のリスト
- 各船の情報:
  - 船名
  - 説明
  - 積載量 / 速度 / 乗員
  - 購入費
  - 購入ボタン

**d) 🤖 オートパイロットパネル**
- 実行時間設定（1～24時間）
- タイマー表示
- 開始/停止ボタン

#### 5. 所持品パネル
- サマリー:
  - 積載状況（XX/XX、XX%）
  - 売却可能額
- 商品リスト:
  - 商品名とアイコン
  - 所持数
  - 売値/個
  - 総売却額

#### 6. 航海日誌パネル
- ログメッセージのスクロールリスト
- データリセットボタン

#### 7. 航海モーダル（航海中のみ表示）
- 航路表示（出発港 → 目的港）
- 経過日数 / 予定日数
- 現在の天候
- 速度（天候影響後）
- 世界地図と航路可視化:
  - 高解像度の世界地図画像（フォールバック付き）
  - 航路を青い点線で表示
  - 出発港（緑マーカー）
  - 目的港（赤マーカー）
  - 船の現在位置（🚢）
- 天候エフェクト（CSS）
- 航海ログ

### UIの更新タイミング
- 状態変更時に `updateAll()` を実行
- 自動セーブもトリガー

### ボタンの無効化条件
- 資金不足
- 在庫不足
- 積載量不足
- 航海中
- 補給品不足

---

## 計算式

### 1. 価格計算
```javascript
// 購入価格
buyPrice = Math.round(
    basePrice × portMultiplier × randomFactor(0.9~1.1)
)

// 売却価格
sellPrice = Math.round(buyPrice × 0.8)
```

### 2. 積載量計算
```javascript
// 使用中の積載量
cargoUsed = Σ(inventory[goodId])

// 空き積載量
cargoSpace = ship.capacity - cargoUsed
```

### 3. 航海時間計算
```javascript
// 基準日数
baseDays = portDistances[from][to]

// 予定日数
estimatedDays = Math.max(1, Math.round(baseDays / ship.speed))

// 実際の日数（天候影響込み）
actualDays = estimatedDays + weatherDelays
```

### 4. 補給品計算
```javascript
// 必要量
foodRequired = Math.ceil(crew × days × 0.07)
waterRequired = Math.ceil(crew × days × 0.07)

// 補給費用
supplyCost = Math.ceil(
    waterNeeded × waterPrice +
    foodNeeded × foodPrice
)
```

### 5. 利益計算
```javascript
// 単位当たり利益
profitPerUnit = sellPrice - buyPrice

// 利益率
profitMargin = (profitPerUnit / buyPrice) × 100

// 総利益
totalProfit = profitPerUnit × quantity
```

### 6. 航海の経過時間計算（リアルタイム）
```javascript
TIME_PER_DAY = 15000  // 15秒 = 1ゲーム日

elapsedRealTime = Date.now() - voyageStartTime
daysElapsed = Math.floor(elapsedRealTime / TIME_PER_DAY)
```

---

## 天候システム

### 天候の種類（5種類）

#### 1. 晴天 ☀️
- **速度係数**: 1.0
- **説明**: 穏やかな航海日和
- **発生確率**: 40%

#### 2. 順風 🌬️
- **速度係数**: 1.2
- **説明**: 追い風を受けて快調
- **発生確率**: 20%

#### 3. 偏西風 🍃
- **速度係数**: 0.9
- **説明**: 強い西風が吹いている
- **発生確率**: 15%

#### 4. 雨 🌧️
- **速度係数**: 0.8
- **説明**: 視界が悪く速度が落ちる
- **発生確率**: 15%

#### 5. 嵐 ⛈️
- **速度係数**: 0.6
- **説明**: 激しい嵐で大幅に遅延
- **発生確率**: 10%

### 天候変化
- 航海中、1日ごとに20%の確率で天候変化
- 天候が悪化すると30%の確率で1日遅延
- 天候履歴を記録

---

## 在庫管理システム

### 港在庫の仕組み

#### 初期化
- ゲーム開始時に全港・全商品が最大在庫量で初期化
- 港サイズによって最大在庫が異なる:
  - small: 30個
  - medium: 60個
  - large: 100個
  - very_large: 150個

#### 在庫回復
- ゲーム時間が経過すると在庫が回復
- 回復量 = 回復率 × 経過日数
- 最大在庫を超えることはない

```javascript
recovered = Math.min(
    maxStock,
    currentStock + (refreshRate × daysPassed)
)
```

#### 在庫減少
- プレイヤーが商品を購入すると在庫減少
- 在庫0の商品は購入不可

#### 在庫回復のタイミング
1. 航海終了時（航海日数分）
2. 休息実行時（1日分）
3. オートパイロット待機時（1日分）

---

## ゲーム進行フロー

### 典型的なゲームサイクル

```
1. 初期状態
   ├─ リスボン港に1100Gで開始
   └─ カラベル船（積載100）

2. 港での活動
   ├─ 商品の購入・売却
   ├─ 利益の出る商品を選択
   └─ 目的地を選択

3. 航海準備
   ├─ 自動補給
   ├─ 推奨商品の確認
   └─ 商品購入

4. 航海実行
   ├─ 「航海を開始する」
   ├─ 航海モーダル表示
   ├─ リアルタイム進行（15秒/日）
   └─ 天候変化

5. 到着
   ├─ 補給品消費
   ├─ 時間経過
   ├─ 在庫回復
   └─ 商品売却

6. 成長
   ├─ 利益の蓄積
   ├─ 船のアップグレード
   └─ より長距離・高利益の航路へ

7. オートパイロット（オプション）
   ├─ 時間設定（1～24時間）
   ├─ 自動貿易実行
   └─ レポート確認
```

### 初期戦略の例
1. リスボンでワインを購入（安い）
2. 長崎へ航海（高く売れる）
3. 長崎で銀を購入（安い）
4. リスボンへ戻る（高く売れる）
5. 利益を蓄積して船をアップグレード

---

## アーキテクチャ

### ディレクトリ構造
```
/src
├── core/
│   ├── game-state.js        # グローバル状態管理
│   └── constants.js         # ゲーム定数
├── services/                # ビジネスロジック
│   ├── autopilot-service.js
│   ├── port-service.js
│   ├── supply-service.js
│   ├── save-service.js
│   ├── trade-service.js
│   └── voyage-service.js
├── ui/                      # UI更新ロジック
│   ├── ui-updater.js
│   └── autopilot-ui.js
├── utils/                   # ユーティリティ
│   ├── calculations.js
│   └── logger.js
└── game.js                  # メインエントリーポイント
```

### モジュール間の依存関係
```
game.js
  ↓
ui-updater.js / autopilot-ui.js
  ↓
services (autopilot, voyage, trade, etc.)
  ↓
utils (calculations, logger)
  ↓
core (game-state, constants)
```

### データフロー
1. ユーザー操作（ボタンクリック等）
2. サービス層の関数呼び出し
3. ゲーム状態の更新
4. UI更新関数の呼び出し
5. 自動セーブ

---

## テスト

### テストファイル
- `test/autopilot.test.js` - オートパイロット機能
- `test/supply.test.js` - 補給システム
- `test/voyage-map.test.js` - 航海マップ
- `test/ship-reload.test.js` - セーブ/ロード

### 実行方法
```bash
npm test
```

---

## 今後の拡張可能性

### 考えられる機能追加
1. **戦闘システム**: 海賊との遭遇
2. **船員管理**: 雇用・解雇・経験値
3. **イベントシステム**: ランダムイベント
4. **実績システム**: 達成目標
5. **マルチプレイヤー**: 他プレイヤーとの競争
6. **新しい港**: さらに多くの都市
7. **季節システム**: 季節による価格変動
8. **船の修理**: 耐久度と修理費用

---

## まとめ

この仕様書は、現在実装されている「大航海時代」ゲームの完全な仕様を網羅しています。
全ての機能は相互に関連し、バランスの取れたゲームプレイ体験を提供するように設計されています。

**コアループ**: 貿易 → 利益 → 船アップグレード → より効率的な貿易

この仕様に基づいて実装を行うことで、一貫性のある高品質なゲーム体験を維持できます。
